---
layout: ../../../layouts/BlogLayout.astro
title: v2.0.x to v2.1
description: New addon APIs and syntax in v2.1.
part: 2
section: Updates and Migrations
---

This update adds quality-of-life features for addon developers, especially for Discover content and task-driven UX.

## New Features

- `catalog` now supports top-level carousel content for Discover.
- `addActionOption` now has clear task wiring with `setTaskName(...)`.
- `search` results can return `downloadType: 'task'` to run addon-defined tasks.
- `onTask(...)` and `task.askForInput(...)` provide a cleaner task flow.
- Addons can now drive full game update flow with `check-for-updates`, `search` (`for: 'update'`), and `setup` (`for: 'update'`).

## Carousel in `catalog`

Return either:
- `Record<string, CatalogSection>`
- or `{ sections, carousel }`

```ts
addon.on('catalog', (event) => {
  event.resolve({
    sections: {
      featured: {
        name: 'Featured',
        description: 'Highlights from this addon',
        listings: [
          {
            appID: 1,
            name: 'Example Game',
            storefront: 'my-store',
            capsuleImage: 'https://example.com/capsule.jpg',
          },
        ],
      },
    },
    carousel: {
      hero1: {
        name: 'Example Game',
        description: 'Top pick this week',
        carouselImage: 'https://example.com/carousel.jpg',
        fullBannerImage: 'https://example.com/banner.jpg',
        appID: 1,
        storefront: 'my-store',
        capsuleImage: 'https://example.com/capsule.jpg',
      },
    },
  });
});
```

### Carousel Field Notes

- Required: `name`, `description`, `carouselImage`.
- Optional but recommended for click-through: `appID`, `storefront`.
- Optional visuals: `fullBannerImage`, `capsuleImage`.

## New Action Button Syntax

Use `setTaskName(...)` for task routing and `setManifest(...)` for task input payload.

```ts
addon.on('configure', (config) =>
  config.addActionOption((option) =>
    option
      .setName('clearCacheAction')
      .setDisplayName('Clear Cache')
      .setDescription('Delete temporary files and rebuild cache')
      .setButtonText('Run Cleanup')
      .setTaskName('maintenance:clear-cache')
      .setManifest({
        scope: 'all',
        includeIndexes: true,
      })
  )
);

addon.onTask('maintenance:clear-cache', async (task, { manifest }) => {
  task.log(`scope=${String(manifest.scope)}`);
  task.setProgress(100);
  task.complete();
});
```

## Task Results from `search`

You can return task entries directly from search results:

```ts
addon.on('search', ({ appID }, event) => {
  event.resolve([
    {
      name: `Verify install for ${appID}`,
      downloadType: 'task',
      taskName: 'verify-install',
      manifest: { deepCheck: true },
    },
  ]);
});

addon.onTask('verify-install', async (task, { libraryInfo, manifest }) => {
  task.log(`app=${libraryInfo?.name ?? 'unknown'}`);
  task.log(`deepCheck=${String(manifest.deepCheck)}`);
  task.complete();
});
```

## `task.askForInput` in Task Handlers

```ts
import { ConfigurationBuilder } from 'ogi-addon';

addon.onTask('verify-install', async (task) => {
  const input = await task.askForInput(
    'Verification Options',
    'Choose how to run checks',
    new ConfigurationBuilder().addBooleanOption((option) =>
      option
        .setName('deepCheck')
        .setDisplayName('Deep Check')
        .setDescription('Run additional integrity checks')
        .setDefaultValue(true)
    )
  );

  task.log(`deepCheck=${input.deepCheck}`);
  task.complete();
});
```

## Migration Checklist

1. Update `ogi-addon` to latest.
2. Replace action task routing via manifest hacks with `setTaskName(...)`.
3. Keep custom payload in `setManifest(...)`.
4. Add `catalog` carousel entries if you want Discover hero content.
5. Register matching `addon.onTask(...)` handlers for every action/task entry.
6. Implement update support with `check-for-updates` + update-mode `search`/`setup` events.

For a full step-by-step implementation, see [Adding Game Update Support](/docs/first-addon/adding-game-updates).

## LLabs / LLM Quick Reference

```ts
// catalog response
type CatalogResponse =
  | Record<string, CatalogSection>
  | {
      sections: Record<string, CatalogSection>;
      carousel?: Record<string, CatalogCarouselItem> | CatalogCarouselItem[];
    };

// action option pattern
config.addActionOption((option) =>
  option
    .setName('actionKey')
    .setDisplayName('Action Label')
    .setDescription('What this action does')
    .setTaskName('task-id')
    .setManifest({ any: 'payload' })
);
```
